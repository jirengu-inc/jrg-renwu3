<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<title>task28-1</title>
<style>
	#header{
		height: 100px;
		line-height: 100px;
		background: red;
		margin-bottom: 20px;
		text-align: center;
	}
	#nav{
		height: 50px;
		line-height: 50px;
		background: blue;
		text-align: center;
	}
	#main{
		border: 15px solid #ccc;
		height: 1500px;
	}
	#footer{
		height: 30px;
		background: black;
	}
	.aside{
		width: 80px;
		height: 400px;
		text-align: center;
		background: green;
		float: left;
	}
</style>
</head>
<body>
	<div id="all">
		<div id="header">header</div>
		<div id="nav">nav</div>
		<div id="main">
			main
			<div class="aside">aside</div>
		</div>
		<div id="footer">footer</div>
	</div>

    <script src="http://apps.bdimg.com/libs/jquery/1.9.1/jquery.js"></script>
    <script>
		$.fn.stick = function(){
    		var $cur = this,
    			curWidth = this.width(),
    			curHeight = this.height(),
    			offsetTop = this.offset().top
					console.log(offsetTop);
    			offsetLeft = $cur.offset().left,
				allTop = $("#all").offset().top;
    		var $curClone = $cur.clone()
			    			.css({
			    				width: curWidth,
			    				height: curHeight,
			    				opacity: 0  				
			    			})
							.insertBefore($cur)
			    			.hide()
			$(window).on("scroll",function(){
				scrollTop = $(this).scrollTop();
				console.log(scrollTop)
				if(scrollTop>=offsetTop){
					if(!isFixed()){
						setFixed();
					}
				}
				else{
					if(isFixed()){
						unSetFixed();
					}
				}
			})

    		function setFixed(){
				$cur.attr("fixed",true);
    			$cur.css({
    				position: "fixed",
					'z-index': 99,
					width: curWidth,
    				top: 0,
    				left: offsetLeft,
    			})
    			$curClone.show();
    		}
    		function unSetFixed(){
				$cur.removeAttr("fixed",false);
    			$cur.removeAttr("style");
    			$curClone.hide();
    		}
    		function isFixed(){
				return !!$cur.attr("fixed")
    		}
    	}
	$("#nav").stick();


    </script>
</body>
</html>