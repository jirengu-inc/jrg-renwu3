<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>task-27-1，轮播</title>
    <link rel="stylesheet" type="text/css" href="style.css">
  </head>
  <body>
    <div class="carousel">
		<ul class="images clearfix">
			<li><img src="http://cdn.jirengu.com/book.jirengu.com/img/10.jpg"></li>
			<li><img src="http://cdn.jirengu.com/book.jirengu.com/img/11.jpg"></li>
			<li><img src="http://cdn.jirengu.com/book.jirengu.com/img/12.jpg"></li>
			<li><img src="http://cdn.jirengu.com/book.jirengu.com/img/13.jpg"></li>
		</ul>
		<a class="pre arrow" href="#"><</a>
		<a class="next arrow" href="#">></a>
		<ol class="circle">
			<li class="active"></li>
			<li></li>
			<li></li>
			<li></li>
		</ol>
    </div>
	<script src="http://apps.bdimg.com/libs/jquery/1.9.1/jquery.js"></script>
    <script>
    	var $ct = $(".images"),
			$images = $ct.children(),
			$pre = $(".pre"),
			$next = $(".next"),
			$circle = $(".circle"),
			imgWidth = $images.width(),
			imgCount = $ct.children().size();

		var current = 0,
			isAnimate = false;

			$pre.on('click',function(){
				playPre();
			})

			$next.on('click',function(){
				playNext();
			})

			$circle.find('li').on('click',function(){
				var idx = $(this).index();
				play(idx);
			})

			play(0);
			autoPlay();

			function playPre(){
				play((imgCount+current-1)%imgCount)
			}

			function playNext(){
				play((current+1)%imgCount)
			}

			function play(idx){
				if(isAnimate){
					return;
				}
				isAnimate = true;
				$images.eq(current).fadeOut(1000);
				$images.eq(idx).fadeIn(1000,function(){
					isAnimate = false;
				});	
				current = idx;
				setCircle();
			}

			function setCircle(){
				$circle.children().removeClass('active').eq(current).addClass('active');
			}

			function autoPlay(){
				var timer = setInterval(function(){
					playNext();
				},2000)
			}

    </script>
  </body>
</html>
