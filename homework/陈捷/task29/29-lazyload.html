<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>29-lazyload</title>
    <style>
    ul,
    li {
        list-style: none;
    }
    
    .container {
        width: 800px;
        margin: 0 auto;
    }
    
    .container:after {
        display: block;
        content: '';
        clear: both;
    }
    
    .container li {
        float: left;
        margin: 10px 10px;
    }
    
    .container li img {
        width: 220px;
        height: 405px;
    }
    
    p {
        float: left;
    }
    </style>
</head>

<body>
    <ul class='container'>
        <li>
            <a href="#"><img src="blank.jpg" lazy-data="girl.jpg"> </a>
        </li>
        <li>
            <a href="#"><img src="blank.jpg" lazy-data="girl.jpg"> </a>
        </li>
        <li>
            <a href="#"><img src="blank.jpg" lazy-data="girl.jpg"> </a>
        </li>
        <li>
            <a href="#"><img src="blank.jpg" lazy-data="girl.jpg"> </a>
        </li>
        <li>
            <a href="#"><img src="blank.jpg" lazy-data="girl.jpg"> </a>
        </li>
        <li>
            <a href="#"><img src="blank.jpg" lazy-data="girl.jpg"> </a>
        </li>
        <li>
            <a href="#"><img src="blank.jpg" lazy-data="girl.jpg"> </a>
        </li>
        <li>
            <a href="#"><img src="blank.jpg" lazy-data="girl.jpg"> </a>
        </li>
        <li>
            <a href="#"><img src="blank.jpg" lazy-data="girl.jpg"> </a>
        </li>
        <li>
            <a href="#"><img src="blank.jpg" lazy-data="girl.jpg"> </a>
        </li>
        <li>
            <a href="#"><img src="blank.jpg" lazy-data="girl.jpg"> </a>
        </li>
        <li>
            <a href="#"><img src="blank.jpg" lazy-data="girl.jpg"> </a>
        </li>
        <li>
            <a href="#"><img src="blank.jpg" lazy-data="girl.jpg"> </a>
        </li>
        <p>手动分割</p>
        <li>
            <a href="#"><img src="blank.jpg" lazy-data="girl.jpg"> </a>
        </li>
        <li>
            <a href="#"><img src="blank.jpg" lazy-data="girl.jpg"> </a>
        </li>
        <li>
            <a href="#"><img src="blank.jpg" lazy-data="girl.jpg"> </a>
        </li>
        <li>
            <a href="#"><img src="blank.jpg" lazy-data="girl.jpg"> </a>
        </li>
        <li>
            <a href="#"><img src="blank.jpg" lazy-data="girl.jpg"> </a>
        </li>
        <li>
            <a href="#"><img src="blank.jpg" lazy-data="girl.jpg"> </a>
        </li>
        <li>
            <a href="#"><img src="blank.jpg" lazy-data="girl.jpg"> </a>
        </li>
        <li>
            <a href="#"><img src="blank.jpg" lazy-data="girl.jpg"> </a>
        </li>
        <li>
            <a href="#"><img src="blank.jpg" lazy-data="girl.jpg"> </a>
        </li>
        <li>
            <a href="#"><img src="blank.jpg" lazy-data="girl.jpg"> </a>
        </li>
        <li>
            <a href="#"><img src="blank.jpg" lazy-data="girl.jpg"> </a>
        </li>
        <li>
            <a href="#"><img src="blank.jpg" lazy-data="girl.jpg"> </a>
        </li>
        <li>
            <a href="#"><img src="blank.jpg" lazy-data="girl.jpg"> </a>
        </li>
        <li>
            <a href="#"><img src="blank.jpg" lazy-data="girl.jpg"> </a>
        </li>
        <li>
            <a href="#"><img src="blank.jpg" lazy-data="girl.jpg"> </a>
        </li>
        <li>
            <a href="#"><img src="blank.jpg" lazy-data="girl.jpg"> </a>
        </li>
        <li>
            <a href="#"><img src="blank.jpg" lazy-data="girl.jpg"> </a>
        </li>
        <li>
            <a href="#"><img src="blank.jpg" lazy-data="girl.jpg"> </a>
        </li>
        <li>
            <a href="#"><img src="blank.jpg" lazy-data="girl.jpg"> </a>
        </li>
        <li>
            <a href="#"><img src="blank.jpg" lazy-data="girl.jpg"> </a>
        </li>
        <li>
            <a href="#"><img src="blank.jpg" lazy-data="girl.jpg"> </a>
        </li>
    </ul>
    <script src="http://apps.bdimg.com/libs/jquery/1.9.1/jquery.js"></script>
    <script>
    var $window = $(window);
    var clock = 0;

    function isVisible($node) {
        return $node.offset().top < $window.height() + $window.scrollTop();
    }

    function isLoaded($node) {
        return !!$node.data('isLoaded');
    }

    function checkShow() {
        $('.container img').each(
            function() {
                var $node = $(this);
                if (!isLoaded($node) && isVisible($node)) {
                    $node.attr('src', $node.attr('lazy-data'));
                    $node.data('isLoaded', true);
                }
            });
    }

    $window.on('scroll', function() {

        if (clock) {
            clearTimeout(clock);
        }
        clock = setTimeout(checkShow(), 300);

    });
    
    checkShow();
    </script>
</body>

</html>
